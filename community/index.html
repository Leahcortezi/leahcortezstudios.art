<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Community Garden - Leah Cortez Studios</title>
    <link href="https://fonts.googleapis.com/css2?family=Pirata+One&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/styles.css">
    <link rel="stylesheet" href="../css/community.css">
    <link rel="icon" type="image/x-icon" href="../icons/favicon.ico">
</head>
<body>
    <!-- Navigation -->
    <nav>
        <div class="nav-container">
            <a href="../index.html" class="logo">
                <img src="../images/logo/logo2.png" alt="Leah Cortez Studio" class="logo-img">
            </a>
            <ul class="nav-menu nav-links">
                <li><a href="../index.html">Home</a></li>
                <li><a href="../bio/index.html">Bio</a></li>
                <li><a href="../collections/index.html">Portfolio</a></li>
                <li><a href="../cv/index.html">CV</a></li>
                <li><a href="index.html">Community</a></li>
                <li><a href="../contact/index.html">Contact</a></li>
            </ul>
            <div class="hamburger">
                <img src="../icons/flower.svg" alt="Menu" class="hamburger-icon">
            </div>
        </div>
    </nav>

    <main>
        <!-- Hero Section -->
        <section class="community-hero">
            <div class="hero-content">
                <h1>Community</h1>
            </div>
        </section>

        <!-- Navigation Tabs -->
        <section class="community-nav">
            <div class="tab-container">
                <button class="tab-btn active" data-tab="prompts">Daily Prompts</button>
                <button class="tab-btn" data-tab="showcase">Community Showcase</button>
                <button class="tab-btn" data-tab="resources">Resources</button>
            </div>
        </section>

        <!-- Daily Prompts Tab -->
        <section class="tab-content active" id="prompts">
            <div class="content-container">
                <h2>Today's Creative Prompt</h2>
                
                <div class="prompt-generator">
                <div class="today-prompt">
                    <div class="prompt-card">
                        <div class="prompt-countdown">
                            <div class="countdown-timer">
                                <div class="time-segment">
                                    <span class="time-value" id="hours">00</span>
                                    <span class="time-label">Hours</span>
                                </div>
                                <div class="time-segment">
                                    <span class="time-value" id="minutes">00</span>
                                    <span class="time-label">Minutes</span>
                                </div>
                                <div class="time-segment">
                                    <span class="time-value" id="seconds">00</span>
                                    <span class="time-label">Seconds</span>
                                </div>
                                </div>
                            </div>
                        <div class="prompt-text" id="dailyPrompt">
                            Create an artwork inspired by nature's patterns and textures
                        </div>
                        <div class="prompt-tags">
                            <span class="tag">daily</span>
                            <span class="tag">creative</span>
                            <span class="tag">artistic</span>
                        </div>
                        <div class="prompt-actions">
                            <button class="new-prompt-btn" onclick="refreshPromptTags()">Refresh Tags</button>
                            <button class="create-from-prompt-btn" onclick="createFromPrompt()">Create from this Prompt</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        </section>

        <!-- Resources Tab -->
        <section class="tab-content" id="resources">
            <div class="content-container">
                <h2>Free Printable Packs</h2>
                
                <!-- Welcome Section -->
                <div class="welcome-section">
                    <div class="welcome-content">
                        <h3>Free Printable Packs - Coming Soon!</h3>
                        <p>I'm currently creating a collection of artistic printables designed for creative minds. Perfect for relaxation, art practice, and making your own mini publications.</p>
                        <p><strong>Coming Soon:</strong> Print-at-home creative resources you can download directly from my site.</p>
                    </div>
                </div>

                <!-- Coming Soon Resources -->
                <div class="coming-soon-section">
                    <h3>Preview: What's Being Created</h3>
                    <div class="preview-grid">
                        <div class="preview-item">
                            <h4>Flash Style Coloring Sheets</h4>
                            <p>Bold, iconic flash art designs perfect for practicing traditional tattoo coloring techniques</p>
                            <span class="coming-soon-badge">Coming Soon</span>
                        </div>
                        <div class="preview-item">
                            <h4>DIY Zine Sets</h4>
                            <p>Complete zine creation kits with templates, covers, and step-by-step assembly guides</p>
                            <span class="coming-soon-badge">Coming Soon</span>
                        </div>
                        <div class="preview-item">
                            <h4>And Many More...</h4>
                            <p>Custom requests, seasonal themes, and experimental creative tools</p>
                            <span class="coming-soon-badge">In Development</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Community Showcase Tab -->
        <section class="tab-content" id="showcase">
            <div class="content-container">
                <h2>Community Showcase</h2>
                
                <!-- Submit Work Button -->
                <div class="submit-work-header">
                    <button class="submit-work-btn" onclick="openSubmissionModal()">
                        Submit Your Work
                    </button>
                    <p class="submit-work-subtitle">Share your artwork with our creative community</p>
                </div>

                <!-- Showcase Filters -->
                <div class="showcase-filters">
                    <button class="filter-toggle" onclick="toggleFilters()">Show Filters</button>
                    <div class="filters-content">
                        <div class="filter-section">
                            <label>Filter:</label>
                            <button class="filter-btn active" data-filter="all">All</button>
                            <button class="filter-btn" data-filter="newest">Newest</button>
                            <button class="filter-btn" data-filter="popular">Most Popular</button>
                            <button class="filter-btn" data-filter="prompt">Prompt Responses</button>
                        </div>
                        
                        <div class="medium-section">
                            <label>Medium:</label>
                            <select class="medium-filter" onchange="filterByMedium(this.value)">
                                <option value="all">All Mediums</option>
                                <option value="mixed-media">Mixed Media</option>
                                <option value="digital">Digital Art</option>
                                <option value="oil">Oil Painting</option>
                                <option value="watercolor">Watercolor</option>
                                <option value="acrylic">Acrylic</option>
                                <option value="charcoal">Charcoal</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Gallery Grid -->
                <div class="showcase-grid">
                    <div class="showcase-item" data-category="all recent" data-medium="mixed-media" data-likes="0" data-date="2025-08-07">
                        <div class="placeholder-image" style="background: linear-gradient(135deg, #7e1c2e, #f8c8d0);"></div>
                        <div class="showcase-overlay">
                            <h4>Memory & Time</h4>
                            <p><a href="https://instagram.com/alexrivera.art" target="_blank" rel="noopener noreferrer" class="instagram-link">@alexrivera.art</a></p>
                            <span class="challenge-tag">Mixed Media</span>
                            <div class="artwork-stats">
                                <button class="like-btn" onclick="toggleLike(this)" data-artwork-id="1">
                                    <span class="heart">â™¡</span>
                                    <span class="like-count" style="display: none;">0</span>
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="showcase-item" data-category="all recent" data-medium="digital" data-likes="0" data-date="2025-08-06">
                        <div class="placeholder-image" style="background: linear-gradient(135deg, #f8c8d0, #7e1c2e);"></div>
                        <div class="showcase-overlay">
                            <h4>Digital Dreams</h4>
                            <p><a href="https://instagram.com/samchen_art" target="_blank" rel="noopener noreferrer" class="instagram-link">@samchen_art</a></p>
                            <span class="challenge-tag">Digital Art</span>
                            <div class="artwork-stats">
                                <button class="like-btn" onclick="toggleLike(this)" data-artwork-id="2">
                                    <span class="heart">â™¡</span>
                                    <span class="like-count" style="display: none;">0</span>
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="showcase-item" data-category="all prompt" data-medium="oil" data-likes="0" data-date="2025-08-05">
                        <div class="placeholder-image" style="background: linear-gradient(45deg, #7e1c2e, #333);"></div>
                        <div class="showcase-overlay">
                            <h4>Urban Solitude</h4>
                            <p><a href="https://instagram.com/jordanblake.creates" target="_blank" rel="noopener noreferrer" class="instagram-link">@jordanblake.creates</a></p>
                            <span class="challenge-tag">Oil Painting</span>
                            <div class="artwork-stats">
                                <button class="like-btn" onclick="toggleLike(this)" data-artwork-id="3">
                                    <span class="heart">â™¡</span>
                                    <span class="like-count" style="display: none;">0</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Artwork Submission Modal -->
     <section class="community-submission" id="submission">
        <div class="content-container">

         <div id="submissionModal" class="modal" onclick="closeSubmissionModal(event)">
             <div class="modal-content" onclick="event.stopPropagation()">
                <div class="modal-header">
                <h3>Share Your Artwork</h3>
                <button class="modal-close" onclick="closeSubmissionModal()">&times;</button>
            </div>
            
            <div class="modal-body">
                <p class="modal-subtitle">Upload your artwork to be featured in our community showcase</p>
                
                <form method="POST" action="https://formsubmit.co/97d276af598369e77984bb3ce5ffbca3" enctype="multipart/form-data" class="artwork-submission-form" onsubmit="return handleFormSubmission(event)">
                    <input type="hidden" name="_subject" value="Community Artwork Submission for Review">
                    <input type="hidden" name="_next" value="https://leahcortezstudios.art/community/#showcase">
                    <input type="hidden" name="_captcha" value="false">
                    <input type="hidden" name="_template" value="box">
                    
                    <!-- Detailed submission info for review -->
                    <input type="hidden" name="submission_type" value="Community Artwork Submission">
                    <input type="hidden" name="submission_date" id="submissionDate">
                    <input type="hidden" name="submission_time" id="submissionTime">
                    <input type="hidden" name="review_status" value="PENDING REVIEW">
                    <input type="hidden" name="instructions" value="Review this artwork submission and add to community showcase if approved.">
                    
                    <div class="form-group">
                        <label for="artistName">Your Name*</label>
                        <input type="text" id="artistName" name="artist_name" placeholder="Your full name" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="artistInstagram">Instagram Handle*</label>
                        <input type="text" id="artistInstagram" name="artist_instagram" placeholder="@yourhandle" required pattern="^@?[A-Za-z0-9._]{1,30}$" title="Enter your Instagram handle (with or without @)">
                    </div>
                    
                    <div class="form-group">
                        <label for="artworkTitle">Artwork Title*</label>
                        <input type="text" id="artworkTitle" name="artwork_title" placeholder="Enter your artwork title" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="artworkFile">Upload Your Artwork*</label>
                        <input type="file" id="artworkFile" name="artwork" accept="image/*" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="artworkDescription">Description (Optional)</label>
                        <textarea id="artworkDescription" name="artwork_description" placeholder="Tell us about your artwork, inspiration, medium used..." rows="3"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="artworkMedium">Medium/Technique</label>
                        <select id="artworkMedium" name="artwork_medium">
                            <option value="">Select medium (optional)</option>
                            <option value="digital">Digital Art</option>
                            <option value="traditional">Traditional Art</option>
                            <option value="mixed-media">Mixed Media</option>
                            <option value="photography">Photography</option>
                            <option value="sculpture">Sculpture</option>
                            <option value="textile">Textile Art</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="artworkCategory">Category</label>
                        <select id="artworkCategory" name="artwork_category">
                            <option value="">Select category (optional)</option>
                            <option value="daily-prompt">Daily Prompt Response</option>
                            <option value="personal">Personal Work</option>
                            <option value="commission">Commission Work</option>
                            <option value="study">Study/Practice</option>
                            <option value="collaboration">Collaboration</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    
                    <div class="modal-footer">
                        <button type="button" class="cancel-btn" onclick="closeSubmissionModal()">Cancel</button>
                        <button type="submit" class="submit-btn">Submit Artwork</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Login/Registration Modal -->
    <div id="loginModal" class="modal" onclick="closeLoginModal(event)">
        <div class="modal-content" onclick="event.stopPropagation()">
            <div class="modal-header">
                <h3>Join Our Community</h3>
                <button class="modal-close" onclick="closeLoginModal()">&times;</button>
            </div>
            
            <div class="modal-body">
                <p class="modal-subtitle">Please sign in to participate in community activities</p>
                
                <!-- Login Form -->
                <div id="loginForm" class="auth-form active">
                    <form class="login-form" onsubmit="handleLogin(event)">
                        <div class="form-group">
                            <label for="loginEmail">Email*</label>
                            <input type="email" id="loginEmail" name="email" placeholder="your@email.com" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="loginName">Display Name*</label>
                            <input type="text" id="loginName" name="name" placeholder="Your Name" required>
                        </div>
                        
                        <div class="form-group">
                            <div class="captcha-container">
                                <label class="captcha-label">
                                    <input type="checkbox" id="robotCheck" required>
                                    <span class="checkmark"></span>
                                    I'm not a robot
                                </label>
                                <div class="captcha-challenge" id="captchaChallenge" style="display: none;">
                                    <p>Please solve: <span id="captchaQuestion"></span></p>
                                    <input type="number" id="captchaAnswer" placeholder="Answer" required>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="communityRules" required>
                                <span class="checkmark"></span>
                                I agree to the <a href="#" onclick="showCommunityRules()">Community Guidelines</a>
                            </label>
                        </div>
                        
                        <div class="modal-footer">
                            <button type="button" class="cancel-btn" onclick="closeLoginModal()">Cancel</button>
                            <button type="submit" class="submit-btn">Join Community</button>
                        </div>
                    </form>
                </div>
                
                <!-- Community Rules -->
                <div id="communityRules" class="community-rules" style="display: none;">
                    <h4>Community Guidelines</h4>
                    <div class="rules-content">
                        <ul>
                            <li><strong>Be Respectful:</strong> Treat all community members with kindness and respect</li>
                            <li><strong>No Spam:</strong> Avoid repetitive posts or promotional content without value</li>
                            <li><strong>No Hate Speech:</strong> Discrimination, harassment, or hate speech is not tolerated</li>
                            <li><strong>Stay On Topic:</strong> Keep posts relevant to art, creativity, and community building</li>
                            <li><strong>Original Content:</strong> Share your own work or properly credit others</li>
                            <li><strong>Constructive Feedback:</strong> Offer helpful, specific feedback when requested</li>
                            <li><strong>Privacy:</strong> Respect others' privacy and don't share personal information</li>
                            <li><strong>Report Issues:</strong> Help keep the community safe by reporting inappropriate content</li>
                        </ul>
                        <p><em>Violations may result in content removal or account suspension.</em></p>
                    </div>
                    <button class="rules-close-btn" onclick="hideCommunityRules()">I Understand</button>
                </div>
            </div>
        </div>
    </div>

    <script>
    // Form submission handler
    async function handleFormSubmission(event) {
        event.preventDefault(); // Prevent default to handle file conversion first
        console.log('Form submission started');
        
        const form = event.target;
        const formData = new FormData(form);
        
        // Populate submission date and time
        const now = new Date();
        document.getElementById('submissionDate').value = now.toLocaleDateString();
        document.getElementById('submissionTime').value = now.toLocaleTimeString();
        
        const name = formData.get('artist_name');
        const instagram = formData.get('artist_instagram');
        const title = formData.get('artwork_title');
        const description = formData.get('artwork_description');
        const medium = formData.get('artwork_medium');
        const category = formData.get('artwork_category');
        const file = formData.get('artwork');
        
        console.log('Form data:', { name, instagram, title, medium, category, file: file ? file.name : 'No file' });
        
        // Validate required fields
        if (!name || !instagram || !title) {
            showNotification('Please fill out all required fields (Name, Instagram Handle, and Artwork Title).', 'error');
            return false;
        }
        
        // Validate Instagram handle format
        const instagramPattern = /^@?[A-Za-z0-9._]{1,30}$/;
        if (!instagramPattern.test(instagram)) {
            showNotification('Please enter a valid Instagram handle (e.g., @yourhandle or yourhandle).', 'error');
            return false;
        }
        
        if (!file || file.size === 0) {
            showNotification('Please select an artwork file to upload.', 'error');
            return false;
        }
        
        // Check file size (3MB limit for base64 embedding)
        if (file.size > 3 * 1024 * 1024) {
            showNotification('File size must be less than 3MB for email viewing. Please choose a smaller image.', 'error');
            return false;
        }
        
        // Show loading state
        const submitBtn = form.querySelector('.submit-btn');
        const originalText = submitBtn.textContent;
        submitBtn.textContent = 'Processing Image...';
        submitBtn.disabled = true;
        
        try {
            // Convert image to base64
            const base64Image = await convertFileToBase64(file);
            
            // Normalize Instagram handle
            let normalizedInstagram = instagram.trim();
            if (!normalizedInstagram.startsWith('@')) {
                normalizedInstagram = '@' + normalizedInstagram;
            }
            
            // Create an HTML email with embedded image
            const emailContent = `
<h2>New Artwork Submission</h2>
<p><strong>Artist Name:</strong> ${name}</p>
<p><strong>Instagram:</strong> <a href="https://instagram.com/${normalizedInstagram.replace('@', '')}">${normalizedInstagram}</a></p>
<p><strong>Artwork Title:</strong> ${title}</p>
<p><strong>Medium:</strong> ${medium || 'Not specified'}</p>
<p><strong>Category:</strong> ${category || 'Not specified'}</p>
<p><strong>Description:</strong> ${description || 'No description provided'}</p>
<p><strong>File Name:</strong> ${file.name}</p>
<p><strong>File Size:</strong> ${(file.size / 1024 / 1024).toFixed(2)} MB</p>
<p><strong>Submission Date:</strong> ${now.toLocaleDateString()} at ${now.toLocaleTimeString()}</p>

<h3>Artwork Image:</h3>
<img src="${base64Image}" style="max-width: 600px; height: auto; border: 1px solid #ddd; border-radius: 8px;" alt="${title}">

<p><em>Right-click the image above to save it to your computer.</em></p>
            `.trim();
            
            // Add the HTML content to a hidden field
            const htmlContentInput = document.createElement('input');
            htmlContentInput.type = 'hidden';
            htmlContentInput.name = 'email_content';
            htmlContentInput.value = emailContent;
            form.appendChild(htmlContentInput);
            
            // Update the description to include image info
            const descriptionInput = form.querySelector('[name="artwork_description"]');
            descriptionInput.value = `${description || 'No description provided'}\n\n[IMAGE EMBEDDED BELOW IN EMAIL]`;
            
            submitBtn.textContent = 'Sending...';
            
            // Submit the form
            form.submit();
            
            // Show success message
            showNotification('Artwork submitted successfully! Your submission has been sent for review.', 'success');
            
            // Close modal after short delay
            setTimeout(() => {
                closeSubmissionModal();
                form.reset();
            }, 2000);
            
        } catch (error) {
            console.error('Processing error:', error);
            showNotification('Failed to process image. Please try again.', 'error');
            submitBtn.textContent = originalText;
            submitBtn.disabled = false;
        }
        
        return false;
    }
    
    // Convert file to base64 data URL
    function convertFileToBase64(file) {
        return new Promise((resolve, reject) => {
            const reader = new FileReader();
            reader.onload = () => resolve(reader.result);
            reader.onerror = reject;
            reader.readAsDataURL(file);
        });
    }

    // Tab functionality
    document.addEventListener('DOMContentLoaded', function() {
        console.log('Tab functionality loaded');
        
        // Initialize poll
        initializePoll();
        
        // Add poll form listener
        const pollForm = document.getElementById('printablePoll');
        if (pollForm) {
            pollForm.addEventListener('submit', submitPoll);
        }
        
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const tabName = btn.dataset.tab;
                console.log('Tab clicked:', tabName);
                
                // Remove active class from all tabs and content
                document.querySelectorAll('.tab-btn, .tab-content').forEach(el => {
                    el.classList.remove('active');
                });
                
                // Add active class to clicked tab and corresponding content
                btn.classList.add('active');
                const targetSection = document.getElementById(tabName);
                if (targetSection) {
                    targetSection.classList.add('active');
                    console.log('Activated section:', tabName);
                } else {
                    console.error('Section not found:', tabName);
                }
            });
        });
    });

    // Daily Prompt Generator with randomized adjectives and keywords  
    const promptTemplates = [
        "Create a {adjective} artwork that explores the concept of {concept} through {medium}",
        "Design a {style} piece that captures the feeling of {emotion} using {technique}",
        "Illustrate a {adjective} scene where {subject} meets {element} in a {setting}",
        "Express the relationship between {concept1} and {concept2} through {artistic_approach}",
        "Create a {adjective} composition that tells the story of {narrative_theme}",
        "Design a piece that transforms {everyday_object} into something {transformation}",
        "Explore the texture of {texture_inspiration} through {medium}",
        "Create a {color_mood} artwork inspired by the {time_period} of {time_of_day}",
        "Illustrate how {abstract_concept} would look if it were {physical_quality}",
        "Design a piece where {natural_element} becomes {metaphor}"
    ];

    const promptVariables = {
        adjective: ["monochromatic", "layered", "delicate", "textured", "geometric", "organic", "minimalist", "maximalist", "fragmented", "flowing", "angular", "soft-edged", "high-contrast", "muted", "luminous", "weathered", "pristine", "distressed", "ethereal", "grounded"],
        concept: ["memory", "identity", "transformation", "connection", "isolation", "growth", "decay", "hope", "fear", "love", "time", "dreams", "reality", "freedom", "belonging", "heritage", "legacy", "journey", "awakening", "reflection"],
        medium: ["watercolor and ink", "digital collage", "mixed media", "charcoal and pastels", "acrylic paint", "pen and ink", "photography manipulation", "textile art", "sculpture elements", "found objects", "gouache", "oil pastels", "printmaking", "fabric and thread", "clay and pigment"],
        style: ["expressionist", "surreal", "minimalist", "maximalist", "impressionist", "abstract", "photorealistic", "folk art inspired", "contemporary", "vintage", "brutalist", "art nouveau", "cubist", "pointillist", "graffiti-inspired"],
        emotion: ["nostalgia", "wonder", "longing", "joy", "contemplation", "excitement", "peacefulness", "intensity", "curiosity", "melancholy", "empowerment", "vulnerability", "serenity", "passion", "tranquility"],
        technique: ["layering techniques", "negative space", "bold color contrasts", "subtle gradients", "textural buildup", "geometric patterns", "organic forms", "light and shadow play", "cross-hatching", "stippling", "glazing", "scumbling", "impasto", "dry brush", "wet-on-wet"],
        subject: ["a forgotten object", "a cultural symbol", "a family memory", "a natural element", "an architectural detail", "a personal ritual", "a childhood story", "an ancestral tradition", "a seasonal change", "a quiet moment"],
        element: ["modern technology", "ancient wisdom", "natural forces", "urban landscapes", "mythical creatures", "everyday magic", "hidden stories", "silent voices", "cultural patterns", "temporal shifts"],
        setting: ["dreamlike landscape", "urban environment", "natural sanctuary", "liminal space", "familiar place made strange", "imaginary realm", "historical context", "futuristic world", "intimate interior", "vast expanse"],
        artistic_approach: ["symbolic representation", "abstract interpretation", "narrative storytelling", "color psychology", "textural exploration", "geometric abstraction", "organic flow", "cultural fusion", "emotional mapping", "visual metaphor"],
        concept1: ["tradition", "progress", "nature", "humanity", "past", "future", "individual", "community", "silence", "voice", "structure", "chaos", "permanence", "change", "visible"],
        concept2: ["innovation", "heritage", "technology", "spirituality", "present", "memory", "collective", "personal", "sound", "expression", "freedom", "order", "transience", "stability", "hidden"],
        narrative_theme: ["cultural heritage", "personal growth", "family legacy", "environmental change", "social connection", "inner journey", "creative awakening", "community bonds", "generational wisdom", "artistic evolution"],
        everyday_object: ["a kitchen utensil", "a piece of clothing", "a plant", "a book", "a window", "a chair", "a photograph", "a key", "a mirror", "a door", "a cup", "a letter", "a tool", "a toy", "a stone"],
        transformation: ["luminous", "transparent", "living", "crystalline", "fluid", "architectural", "musical", "temporal", "ethereal", "monumental", "delicate", "powerful", "sacred", "revolutionary", "elemental"],
        texture_inspiration: ["tree bark", "flowing water", "weathered stone", "fabric weave", "skin", "metal patina", "flower petals", "sand dunes", "rain patterns", "aged paper", "rust", "moss", "scales", "feathers", "crystal formations"],
        color_mood: ["monochromatic earth tones", "vibrant jewel palette", "muted pastels", "high contrast black and white", "warm sunset hues", "cool oceanic blues", "metallic accents", "desert sand palette", "forest greens", "urban grays"],
        time_period: ["golden hour", "blue hour", "midnight", "dawn", "stormy afternoon", "quiet morning", "busy evening", "peaceful night", "twilight", "midday sun"],
        time_of_day: ["spring awakening", "summer abundance", "autumn transition", "winter stillness", "rainy season", "dry season", "harvest time", "growing season"],
        abstract_concept: ["rhythm", "silence", "momentum", "gravity", "resonance", "emotion", "memory", "dreams", "thoughts", "energy", "balance", "tension", "harmony", "discord", "flow"],
        physical_quality: ["tangible", "translucent", "textured", "smooth", "rough", "layered", "solid", "flowing", "glowing", "growing", "fragmented", "unified", "dense", "airy", "structured"],
        natural_element: ["water", "fire", "earth", "air", "lightning", "mist", "sunlight", "shadows", "roots", "seeds", "wind", "rain", "snow", "stone", "wood"],
        metaphor: ["a bridge", "a voice", "a guardian", "a storyteller", "a teacher", "a healer", "a messenger", "a sanctuary", "a journey", "a celebration", "a mirror", "a vessel", "a pathway", "a threshold", "a tapestry"]
    };

    let currentDailyPrompt = null;
    let promptDate = null;

    function generateDailyPrompt() {
        console.log('Generating daily prompt...');
        const today = new Date().toDateString();
        
        // Check if we already have a prompt for today
        const storedPrompt = localStorage.getItem('dailyPrompt');
        const storedDate = localStorage.getItem('promptDate');
        
        console.log('Stored prompt:', storedPrompt, 'Stored date:', storedDate, 'Today:', today);
        
        if (storedPrompt && storedDate === today) {
            // Use existing prompt for today
            currentDailyPrompt = storedPrompt;
            const promptElement = document.getElementById('dailyPrompt');
            if (promptElement) {
                promptElement.textContent = currentDailyPrompt;
                console.log('Used stored prompt:', currentDailyPrompt);
            }
            updatePromptTags();
            return;
        }
        
        // Generate new prompt for today
        const template = promptTemplates[Math.floor(Math.random() * promptTemplates.length)];
        let prompt = template;
        
        console.log('Selected template:', template);
        
        // Replace placeholders with random words
        const placeholderRegex = /{(\w+)}/g;
        prompt = prompt.replace(placeholderRegex, (match, key) => {
            if (promptVariables[key]) {
                const options = promptVariables[key];
                const selected = options[Math.floor(Math.random() * options.length)];
                console.log('Replacing', match, 'with', selected);
                return selected;
            }
            return match;
        });
        
        currentDailyPrompt = prompt;
        console.log('Generated new prompt:', prompt);
        
        // Store in localStorage
        localStorage.setItem('dailyPrompt', prompt);
        localStorage.setItem('promptDate', today);
        
        // Update display immediately
        const promptElement = document.getElementById('dailyPrompt');
        if (promptElement) {
            promptElement.textContent = prompt;
            console.log('Updated prompt display with:', prompt);
        } else {
            console.error('Prompt element not found!');
        }
        updatePromptTags();
        
        // Add to history if it's a new day
        addPromptToHistory(prompt);
    }

    function updatePromptTags() {
        const tagContainer = document.querySelector('.prompt-tags');
        if (!tagContainer) return;
        
        // Define tag categories to prevent clashing
        const tagCategories = {
            style: ["expressive", "contemplative", "intuitive", "experimental", "atmospheric", "gestural", "spontaneous", "personal", "intimate", "dreamy", "playful", "nostalgic"],
            approach: ["structured", "fluid", "loose", "controlled", "focused", "grounded", "balanced", "rhythmic", "open", "unified"],
            quality: ["bold", "subtle", "raw", "refined", "precise", "dynamic", "layered", "simplified", "rich", "spare"],
            mood: ["warm", "ethereal", "earthy", "flowing", "weightless", "expansive", "traditional", "contemporary", "natural", "urban"],
            form: ["organic", "geometric", "smooth", "textured", "angular", "curved", "linear", "circular", "fragmented", "contained"]
        };
        
        const selectedTags = [];
        const usedCategories = [];
        
        // Select 3-4 tags from different categories to avoid clashing
        const tagCount = Math.floor(Math.random() * 2) + 3; // 3 or 4 tags
        const categoryKeys = Object.keys(tagCategories);
        
        while (selectedTags.length < tagCount && usedCategories.length < categoryKeys.length) {
            const randomCategoryIndex = Math.floor(Math.random() * categoryKeys.length);
            const categoryKey = categoryKeys[randomCategoryIndex];
            
            // Skip if we've already used this category
            if (usedCategories.includes(categoryKey)) continue;
            
            const categoryTags = tagCategories[categoryKey];
            const randomTag = categoryTags[Math.floor(Math.random() * categoryTags.length)];
            
            selectedTags.push(randomTag);
            usedCategories.push(categoryKey);
        }
        
        tagContainer.innerHTML = selectedTags.map(tag => `<span class="tag">${tag}</span>`).join('');
    }

    function generateNewPrompt() {
        // Only refresh the tags, keep the same prompt for the day
        updatePromptTags();
    }

    function addPromptToHistory(prompt) {
        const historyContainer = document.getElementById('promptHistory');
        if (!historyContainer) return;
        
        const promptElement = document.createElement('div');
        promptElement.className = 'prompt-history-item';
        promptElement.innerHTML = `
            <p>${prompt}</p>
            <small>${new Date().toLocaleDateString()}</small>
        `;
        historyContainer.insertBefore(promptElement, historyContainer.firstChild);
        
        // Keep only last 7 prompts
        while (historyContainer.children.length > 7) {
            historyContainer.removeChild(historyContainer.lastChild);
        }
        
        // Save history to localStorage
        const history = Array.from(historyContainer.children).map(item => ({
            prompt: item.querySelector('p').textContent,
            date: item.querySelector('small').textContent
        }));
        localStorage.setItem('promptHistory', JSON.stringify(history));
    }

    function loadPromptHistory() {
        const historyContainer = document.getElementById('promptHistory');
        if (!historyContainer) return;
        
        const savedHistory = localStorage.getItem('promptHistory');
        if (savedHistory) {
            const history = JSON.parse(savedHistory);
            history.forEach(item => {
                const promptElement = document.createElement('div');
                promptElement.className = 'prompt-history-item';
                promptElement.innerHTML = `
                    <p>${item.prompt}</p>
                    <small>${item.date}</small>
                `;
                historyContainer.appendChild(promptElement);
            });
        }
    }

    // Artwork submission image preview
    function previewSubmissionImage(input) {
        const preview = document.getElementById('submissionImagePreview');
        const uploadArea = document.querySelector('.file-upload-area');
        const file = input.files[0];
        
        if (file) {
            // Validate file size (10MB limit)
            if (file.size > 10 * 1024 * 1024) {
                alert('File size must be less than 10MB. Please choose a smaller image.');
                input.value = '';
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                preview.innerHTML = `
                    <img src="${e.target.result}" alt="Artwork preview" style="max-width: 300px; max-height: 300px; border-radius: 12px; border: 2px solid rgba(248, 200, 208, 0.3); object-fit: cover;">
                    <p style="color: #f8c8d0; margin-top: 15px; font-size: 0.9rem;">âœ… Image selected: ${file.name}</p>
                    <button type="button" onclick="clearSubmissionImage()" style="background: rgba(126, 28, 46, 0.2); border: 1px solid #f8c8d0; color: #f8c8d0; padding: 8px 16px; border-radius: 8px; cursor: pointer; margin-top: 10px;">Remove Image</button>
                `;
            };
            reader.readAsDataURL(file);
            
            // Update upload area styling
            uploadArea.style.borderColor = '#f8c8d0';
            uploadArea.style.background = 'rgba(248, 200, 208, 0.1)';
            uploadArea.innerHTML = '<p style="color: #f8c8d0;">ðŸ“¸ Image selected! Click to change</p>';
        }
    }

    function clearSubmissionImage() {
        const preview = document.getElementById('submissionImagePreview');
        const uploadArea = document.querySelector('.file-upload-area');
        const fileInput = document.getElementById('artworkFile');
        
        preview.innerHTML = '';
        uploadArea.style.borderColor = 'rgba(248, 200, 208, 0.4)';
        uploadArea.style.background = 'rgba(248, 200, 208, 0.02)';
        uploadArea.innerHTML = `
            <p>Click to upload your artwork</p>
            <p class="upload-note">Supported formats: PNG, JPEG, GIF, WebP (Max 10MB)</p>
        `;
        fileInput.value = '';
    }

    // Modal functionality
    function openSubmissionModal() {
        const modal = document.getElementById('submissionModal');
        modal.classList.add('show');
        modal.style.display = 'flex';
        document.body.style.overflow = 'hidden'; // Prevent background scrolling
    }

    // Helper function to update countdown display
    function updateCountdownDisplay(timeRemaining) {
        const hours = Math.floor(timeRemaining / (1000 * 60 * 60));
        const minutes = Math.floor((timeRemaining % (1000 * 60 * 60)) / (1000 * 60));
        const seconds = Math.floor((timeRemaining % (1000 * 60)) / 1000);
        
        // Update individual time elements
        const hoursElement = document.getElementById('hours');
        const minutesElement = document.getElementById('minutes');
        const secondsElement = document.getElementById('seconds');
        
        if (hoursElement) hoursElement.textContent = hours.toString().padStart(2, '0');
        if (minutesElement) minutesElement.textContent = minutes.toString().padStart(2, '0');
        if (secondsElement) secondsElement.textContent = seconds.toString().padStart(2, '0');
    }

    // Show notification messages
    function showNotification(message, type = 'info') {
        // Create notification element if it doesn't exist
        let notification = document.getElementById('notification');
        if (!notification) {
            notification = document.createElement('div');
            notification.id = 'notification';
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 15px 20px;
                border-radius: 8px;
                color: white;
                font-weight: bold;
                z-index: 1000;
                max-width: 300px;
                transform: translateX(100%);
                transition: transform 0.3s ease;
            `;
            document.body.appendChild(notification);
        }
        
        // Set styles based on type
        if (type === 'success') {
            notification.style.backgroundColor = '#4CAF50';
        } else if (type === 'error') {
            notification.style.backgroundColor = '#f44336';
        } else {
            notification.style.backgroundColor = '#2196F3';
        }
        
        notification.textContent = message;
        
        // Slide in
        setTimeout(() => {
            notification.style.transform = 'translateX(0)';
        }, 100);
        
        // Hide after 5 seconds
        setTimeout(() => {
            notification.style.transform = 'translateX(100%)';
        }, 5000);
    }

    // Countdown timer for next prompt with automatic update
    function updateCountdown() {
        const now = new Date();
        const tomorrow = new Date(now);
        tomorrow.setDate(tomorrow.getDate() + 1);
        tomorrow.setHours(0, 0, 0, 0); // Set to midnight
        
        const timeUntilTomorrow = tomorrow.getTime() - now.getTime();
        
        // If we've reached midnight (or past), generate a new prompt
        if (timeUntilTomorrow <= 1000) { // Within 1 second of midnight
            console.log('Midnight reached! Generating new prompt...');
            
            // Clear old prompt data to force new generation
            localStorage.removeItem('dailyPrompt');
            localStorage.removeItem('promptDate');
            
            // Generate new prompt
            generateDailyPrompt();
            
            // Show notification about new prompt
            showNotification('A new daily prompt has arrived! Start creating!', 'success');
            
            // Recalculate countdown for the new day
            const newTomorrow = new Date(now);
            newTomorrow.setDate(newTomorrow.getDate() + 1);
            newTomorrow.setHours(0, 0, 0, 0);
            const newTimeUntilTomorrow = newTomorrow.getTime() - now.getTime();
            updateCountdownDisplay(newTimeUntilTomorrow);
        } else {
            updateCountdownDisplay(timeUntilTomorrow);
        }
    }

    // Close modal with Escape key
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
            closeSubmissionModal();
            closeResourceModal();
        }
    });

    // Color palette generator
    function generatePalette() {
        const palette = document.getElementById('colorPalette');
        const swatches = palette.querySelectorAll('.color-swatch');
        
        swatches.forEach(swatch => {
            const hue = Math.floor(Math.random() * 360);
            const saturation = Math.floor(Math.random() * 50) + 30; // 30-80%
            const lightness = Math.floor(Math.random() * 40) + 30; // 30-70%
            swatch.style.background = `hsl(${hue}, ${saturation}%, ${lightness}%)`;
        });
    }

    // Composition guide
    document.getElementById('compositionType').addEventListener('change', (e) => {
        const grid = document.getElementById('gridOverlay');
        const type = e.target.value;
        
        grid.className = `grid-overlay ${type}`;
    });

    // Initialize page
    document.addEventListener('DOMContentLoaded', () => {
        console.log('Community page loaded - initializing...');
        
        // Force clear old data for fresh start
        localStorage.removeItem('dailyPrompt');
        localStorage.removeItem('promptDate');
        
        // Generate fresh prompt
        try {
            console.log('Starting prompt generation...');
            generateDailyPrompt();
        } catch (error) {
            console.error('Error generating daily prompt:', error);
            // Fallback prompt
            const promptElement = document.getElementById('dailyPrompt');
            if (promptElement) {
                promptElement.textContent = "Create an artwork that explores the concept of transformation through mixed media";
            }
        }
        
        // Start countdown timer immediately
        try {
            updateCountdown();
            setInterval(updateCountdown, 1000); // Update every second
        } catch (error) {
            console.error('Error with countdown:', error);
        }
        
        // Initialize stats with animation
        try {
            animateNumbers();
        } catch (error) {
            console.error('Error animating numbers:', error);
        }
        
        // Initialize showcase filters
        try {
            initializeShowcaseFilters();
        } catch (error) {
            console.error('Error initializing showcase filters:', error);
        }
    });

    function animateNumbers() {
        const counters = document.querySelectorAll('.stat-number');
        counters.forEach(counter => {
            const target = parseInt(counter.textContent);
            let current = 0;
            const increment = target / 50;
            const timer = setInterval(() => {
                current += increment;
                if (current >= target) {
                    current = target;
                    clearInterval(timer);
                }
                counter.textContent = Math.floor(current);
            }, 30);
        });
    }

    // Art Block Breaker Functions
    function openBlockBuster(type) {
        // Hide all generators first
        document.querySelectorAll('.interactive-generator').forEach(gen => {
            gen.style.display = 'none';
        });
        
        // Map the type to the correct ID
        const generatorMap = {
            'color': 'colorMoodGenerator',
            'style': 'styleFusionGenerator', 
            'subject': 'subjectTransformer',
            'technique': 'techniqueMixer'
        };
        
        // Show the selected generator
        const generatorId = generatorMap[type];
        const generator = document.getElementById(generatorId);
        if (generator) {
            generator.style.display = 'block';
            generator.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }
        
        // Update active state
        document.querySelectorAll('.buster-card').forEach(card => {
            card.classList.remove('active');
        });
        event.target.closest('.buster-card').classList.add('active');
    }

    function generateMoodPalette() {
        const energy = document.getElementById('energySlider').value;
        const emotion = document.getElementById('emotionSlider').value;
        const complexity = document.getElementById('complexitySlider').value;
        const colorCount = document.getElementById('colorCount').value;
        
        // Color palettes based on mood
        const palettes = {
            energetic: ['#FF6B35', '#F7931E', '#FFD23F', '#06FFA5', '#118AB2'],
            calm: ['#264653', '#2A9D8F', '#E9C46A', '#F4A261', '#E76F51'],
            mysterious: ['#2D1B69', '#11213F', '#0F3460', '#16537E', '#533A7B'],
            vibrant: ['#E63946', '#F77F00', '#FCBF49', '#06FFA5', '#277DA1'],
            earthy: ['#8B4513', '#D2691E', '#CD853F', '#F4A460', '#DEB887'],
            monochrome: ['#000000', '#404040', '#808080', '#C0C0C0', '#FFFFFF']
        };
        
        // Select palette based on emotion value
        let selectedPalette;
        if (emotion < 20) selectedPalette = palettes.calm;
        else if (emotion < 40) selectedPalette = palettes.earthy;
        else if (emotion < 60) selectedPalette = palettes.mysterious;
        else if (emotion < 80) selectedPalette = palettes.vibrant;
        else selectedPalette = palettes.energetic;
        
        // Shuffle and select colors
        const shuffled = [...selectedPalette].sort(() => 0.5 - Math.random());
        const finalColors = shuffled.slice(0, colorCount);
        
        // Display the palette
        const paletteContainer = document.getElementById('moodPaletteResult');
        paletteContainer.innerHTML = finalColors.map(color => 
            '<div class="color-swatch" style="background-color: ' + color + ';" title="' + color + '"></div>'
        ).join('');
        
        // Show result
        document.getElementById('colorResult').style.display = 'block';
        
        // Generate mood description
        const moodDesc = document.getElementById('moodDescription');
        const energyDesc = energy < 30 ? 'low-energy' : energy < 70 ? 'balanced' : 'high-energy';
        const emotionDesc = emotion < 30 ? 'serene' : emotion < 70 ? 'warm' : 'intense';
        moodDesc.textContent = `This ${energyDesc}, ${emotionDesc} palette encourages ${getCreativePrompt(energy, emotion)}.`;
    }

    function getCreativePrompt(energy, emotion) {
        const prompts = {
            low_serene: 'contemplative mark-making and gentle textures',
            low_warm: 'soft blending and subtle color transitions',
            low_intense: 'dramatic contrasts with controlled application',
            balanced_serene: 'harmonious composition with mindful placement',
            balanced_warm: 'expressive brushwork and confident strokes',
            balanced_intense: 'bold statements with purposeful restraint',
            high_serene: 'dynamic movement within peaceful themes',
            high_warm: 'energetic expression with joyful abandon',
            high_intense: 'explosive creativity and fearless experimentation'
        };
        
        const energyKey = energy < 30 ? 'low' : energy < 70 ? 'balanced' : 'high';
        const emotionKey = emotion < 30 ? 'serene' : emotion < 70 ? 'warm' : 'intense';
        
        return prompts[`${energyKey}_${emotionKey}`] || 'creative exploration';
    }

    function generateStyleFusion() {
        const primary = document.getElementById('primaryMovement').value;
        const secondary = document.getElementById('secondaryInfluence').value;
        const technique = document.getElementById('techniqueFocus').value;
        
        const fusionResult = document.getElementById('fusionResult');
        const keyPoints = document.getElementById('styleKeyPoints');
        
        // Generate fusion description
        const descriptions = {
            impressionism: 'capturing light and movement with loose brushwork',
            expressionism: 'conveying emotion through bold color and distorted forms',
            abstract: 'exploring pure form, color, and composition',
            realism: 'precise observation and detailed representation',
            surrealism: 'blending dreams and reality in unexpected ways',
            minimalism: 'using essential elements for maximum impact'
        };
        
        const techniques = {
            color: 'Focus on color relationships, temperature, and harmony',
            texture: 'Explore surface quality, mark-making, and tactile elements',
            composition: 'Emphasize visual flow, balance, and spatial relationships',
            light: 'Study illumination, shadow, and atmospheric effects'
        };
        
        fusionResult.textContent = `${primary.charAt(0).toUpperCase() + primary.slice(1)} meets ${secondary} - ${descriptions[primary]} while ${descriptions[secondary]}.`;
        
        keyPoints.innerHTML = `
            <li><strong>Primary Approach:</strong> ${descriptions[primary]}</li>
            <li><strong>Secondary Influence:</strong> ${descriptions[secondary]}</li>
            <li><strong>Technical Focus:</strong> ${techniques[technique]}</li>
            <li><strong>Fusion Goal:</strong> Create a unique voice that bridges both styles</li>
        `;
        
        document.getElementById('styleResult').style.display = 'block';
    }

    function generateSubjectTransform() {
        // This function is called when user clicks the transform button
        // The subject should already be set by one of the input methods
        let subject = '';
        
        // Check which method is active
        const activeMethod = document.querySelector('.input-tab.active').dataset.method;
        
        if (activeMethod === 'random') {
            const randomSubjects = [
                'old bicycle', 'morning coffee', 'stormy sky', 'sleeping cat', 'city reflection',
                'garden gate', 'vintage chair', 'autumn leaf', 'flowing water', 'empty room',
                'bird in flight', 'weathered hands', 'distant mountains', 'urban alley', 'floating balloon'
            ];
            subject = randomSubjects[Math.floor(Math.random() * randomSubjects.length)];
        } else if (activeMethod === 'custom') {
            subject = document.getElementById('customSubject').value || 'your chosen subject';
        } else {
            subject = 'something from your immediate surroundings';
        }
        
        const transformations = [
            `Reimagine ${subject} as if viewed through water`,
            `Show ${subject} from an ant's perspective`,
            `Depict ${subject} in the style of a child's drawing`,
            `Transform ${subject} into pure geometric shapes`,
            `Render ${subject} as it might appear in a dream`,
            `Show only the shadows cast by ${subject}`,
            `Depict ${subject} as if it were made of light`,
            `Transform ${subject} into an abstract emotion`,
            `Show ${subject} through the eyes of someone who's never seen it before`,
            `Reimagine ${subject} as a landscape element`
        ];
        
        const randomTransform = transformations[Math.floor(Math.random() * transformations.length)];
        
        document.getElementById('transformResult').textContent = randomTransform;
        document.getElementById('subjectResult').style.display = 'block';
    }

    // Additional functions for Subject Transformer
    function switchInputMethod(method) {
        // Update tab states
        document.querySelectorAll('.input-tab').forEach(tab => {
            tab.classList.remove('active');
        });
        document.querySelector(`[data-method="${method}"]`).classList.add('active');
        
        // Show/hide method sections
        document.querySelectorAll('.input-method').forEach(section => {
            section.style.display = 'none';
        });
        document.getElementById(method + 'Method').style.display = 'block';
    }

    function getRandomSubject() {
        const subjects = [
            'old bicycle', 'morning coffee', 'stormy sky', 'sleeping cat', 'city reflection',
            'garden gate', 'vintage chair', 'autumn leaf', 'flowing water', 'empty room',
            'bird in flight', 'weathered hands', 'distant mountains', 'urban alley', 'floating balloon',
            'forgotten toy', 'crumpled paper', 'street lamp', 'puddle reflection', 'wind chime'
        ];
        const randomSubject = subjects[Math.floor(Math.random() * subjects.length)];
        
        document.getElementById('randomSubjectDisplay').textContent = randomSubject;
        document.getElementById('randomSubjectResult').style.display = 'block';
    }

    function previewCustomSubject() {
        const input = document.getElementById('customSubject').value;
        if (input.trim()) {
            document.getElementById('customSubjectDisplay').textContent = input;
            document.getElementById('customSubjectResult').style.display = 'block';
        } else {
            document.getElementById('customSubjectResult').style.display = 'none';
        }
    }

    function selectSurrounding(item) {
        document.getElementById('surroundingsDisplay').textContent = item;
        document.getElementById('surroundingsResult').style.display = 'block';
        
        // Update button states
        document.querySelectorAll('.surrounding-btn').forEach(btn => {
            btn.classList.remove('selected');
        });
        event.target.classList.add('selected');
    }

    function closeBlockBuster() {
        document.querySelectorAll('.interactive-generator').forEach(gen => {
            gen.style.display = 'none';
        });
        document.querySelectorAll('.buster-card').forEach(card => {
            card.classList.remove('active');
        });
    }

    function generateTechniqueMix() {
        const medium = document.getElementById('primaryMedium').value;
        const experimental = document.getElementById('experimentalFactor').value;
        
        const techniques = {
            watercolor: ['wet-on-wet bleeding', 'salt texture effects', 'masking fluid resist', 'layered glazing'],
            acrylic: ['impasto texture', 'color mixing on canvas', 'glazing techniques', 'palette knife work'],
            oil: ['alla prima painting', 'scumbling effects', 'glazing layers', 'broken color technique'],
            digital: ['custom brush creation', 'layer blending modes', 'digital collage', 'texture overlays'],
            mixed: ['collage integration', 'resist techniques', 'found object inclusion', 'multimedia layering']
        };
        
        const experimental_factors = {
            low: 'subtle variations on traditional methods',
            medium: 'combining two complementary techniques',
            high: 'bold experimentation with unconventional tools'
        };
        
        const selectedTechniques = techniques[medium] || techniques.mixed;
        const randomTechnique = selectedTechniques[Math.floor(Math.random() * selectedTechniques.length)];
        
        document.getElementById('techniqueResult').innerHTML = `
            <h4>Today's Technique Challenge:</h4>
            <p><strong>Primary Method:</strong> ${randomTechnique}</p>
            <p><strong>Experimental Approach:</strong> ${experimental_factors[experimental]}</p>
            <p><strong>Bonus Challenge:</strong> Try this technique with your non-dominant hand for the first 5 minutes</p>
        `;
        
        document.getElementById('mixResult').style.display = 'block';
    }

    // Community Hub Functions
    function openDiscussions() {
        alert('Artist Discussions feature coming soon! Join our community to participate in creative conversations.');
    }

    function openLearning() {
        alert('Learning Circle feature coming soon! Share and discover tutorials, tips, and techniques.');
    }

    function openChallenges() {
        alert('Weekly Challenges feature coming soon! Participate in themed art challenges with the community.');
    }

    function openBuddySystem() {
        alert('Art Buddy System feature coming soon! Find accountability partners and artistic mentors.');
    }

    function shareProgress() {
        alert('Share Progress feature coming soon! Show your artistic journey with the community.');
    }

    function askForFeedback() {
        alert('Ask for Feedback feature coming soon! Get constructive criticism from fellow artists.');
    }

    // Solo Artist Building Functions - Detailed Guidance
    function documentWork() {
        alert('ðŸ“¸ Document Your Creative Process:\n\nâ€¢ Take photos at different stages (sketch, halfway, finished)\nâ€¢ Note what techniques and materials you used\nâ€¢ Record your thoughts, decisions, and happy accidents\nâ€¢ Save these for future social media posts\nâ€¢ Include your workspace and tools occasionally\nâ€¢ Capture details that show your unique approach\n\nTip: Good documentation is the foundation of building an authentic online presence. People love seeing the journey, not just the destination!');
    }

    function exploreHashtags() {
        alert('#ï¸âƒ£ Research Art Hashtags Strategy:\n\nâ€¢ Look up #[yourmedia]art (e.g., #watercolorart, #oilpainting)\nâ€¢ Find hashtags with 10k-100k posts (sweet spot for visibility)\nâ€¢ Check what successful artists in your style use\nâ€¢ Mix popular and niche hashtags (70/30 split)\nâ€¢ Save 15-20 relevant hashtags for easy copying\nâ€¢ Avoid banned or overly generic hashtags\n\nTip: Good hashtags help the RIGHT people find your work. Quality engagement beats quantity!');
    }

    function studyArtists() {
        alert('ðŸ” Study Artists in Your Medium:\n\nâ€¢ Find 5-10 artists whose style resonates with you\nâ€¢ Note what techniques and approaches they use\nâ€¢ Observe how they photograph and present their work\nâ€¢ See how they describe their process and inspiration\nâ€¢ Follow their artistic journey for ongoing inspiration\nâ€¢ Notice what makes their work distinctive\n\nTip: Study successful artists to learn professional practices, but never copy. Let them inspire your unique voice!');
    }

    function writeAboutArt() {
        alert('âœï¸ Practice Writing About Your Art:\n\nâ€¢ Describe your process in simple, relatable terms\nâ€¢ Share what inspired this particular piece\nâ€¢ Mention specific challenges you faced and overcame\nâ€¢ Explain techniques you used or experimented with\nâ€¢ Keep notes and drafts for future social media captions\nâ€¢ Practice storytelling, not just describing\n\nTip: People connect with stories and vulnerability. Share your genuine experience, and others will relate to your artistic journey!');
    }

    function addPersonalGoal() {
        const goal = prompt('What small creative goal would you like to set?\n\nExamples:\nâ€¢ Take progress photos of 3 finished pieces\nâ€¢ Write artist bio draft (2-3 paragraphs)\nâ€¢ Research 5 local art groups or online communities\nâ€¢ Complete one small painting this week\nâ€¢ Practice describing my work in 2-3 sentences\nâ€¢ Set up better lighting for photo documentation\n\nYour goal:');
        if (goal && goal.trim()) {
            alert('ðŸŽ¯ Goal Added Successfully!\n\n"' + goal + '"\n\nRemember: Small, consistent steps lead to significant progress. You\'ve got this! Breaking big dreams into small, actionable goals is how every successful artist builds their practice.');
        }
    }

    // Community Showcase Functions
    function submitArtwork() {
        alert('ðŸŽ¨ Submit Your Artwork:\n\nWe\'re building a supportive community showcase for emerging artists!\n\nTo be featured:\nâ€¢ Share your artistic journey and growth\nâ€¢ Include 2-3 of your best pieces\nâ€¢ Tell us about your creative process\nâ€¢ Describe challenges you\'ve overcome\n\nFeatures will highlight authentic stories of artistic development. Stay tuned for submission guidelines!');
    }

    // Gallery Filter Functionality
    function initializeShowcaseFilters() {
        const filterButtons = document.querySelectorAll('.filter-btn');
        const showcaseItems = document.querySelectorAll('.showcase-item');
        
        filterButtons.forEach(button => {
            button.addEventListener('click', function() {
                const filter = this.getAttribute('data-filter');
                
                // Update active button
                filterButtons.forEach(btn => btn.classList.remove('active'));
                this.classList.add('active');
                
                // Filter items
                showcaseItems.forEach(item => {
                    if (filter === 'all' || item.getAttribute('data-category').includes(filter)) {
                        item.style.display = 'block';
                        item.style.animation = 'fadeIn 0.3s ease-in';
                    } else {
                        item.style.display = 'none';
                    }
                });
            });
        });
    }

    // Submission Modal Functions
    function openSubmissionModal() {
        const modal = document.getElementById('submissionModal');
        if (modal) {
            modal.classList.add('show');
            modal.style.display = 'flex';
            document.body.style.overflow = 'hidden';
        }
    }

    function closeSubmissionModal(event) {
        const modal = document.getElementById('submissionModal');
        if (modal && (!event || event.target === modal || event.target.classList.contains('modal-close') || event.target.classList.contains('cancel-btn'))) {
            modal.classList.remove('show');
            modal.style.display = 'none';
            document.body.style.overflow = 'auto';
            // Reset form
            const form = document.querySelector('.artwork-submission-form');
            if (form) {
                form.reset();
                if (preview) preview.innerHTML = '';
            }
        }
    }

    function previewSubmissionImage(input) {
        const preview = document.getElementById('submissionImagePreview');
        if (input.files && input.files[0] && preview) {
            const reader = new FileReader();
            reader.onload = function(e) {
                preview.innerHTML = `
                    <div class="preview-container">
                        <img src="${e.target.result}" alt="Artwork preview" style="max-width: 200px; max-height: 200px; border-radius: 8px;">
                        <p class="preview-filename">${input.files[0].name}</p>
                    </div>
                `;
            };
            reader.readAsDataURL(input.files[0]);
        }
    }

    function shareProgress() {
        alert('ðŸ“¸ Share Your Progress:\n\nDocument and share your artistic journey:\n\nâ€¢ Take photos of works in progress\nâ€¢ Share technique discoveries\nâ€¢ Post about creative challenges\nâ€¢ Show your workspace evolution\nâ€¢ Celebrate small wins\n\nYour progress inspires other emerging artists. Every step forward matters!');
    }

    function connectArtists() {
        alert('ðŸ¤ Connect with Fellow Artists:\n\nBuild meaningful artistic relationships:\n\nâ€¢ Follow artists in your medium\nâ€¢ Engage genuinely with their work\nâ€¢ Share encouraging comments\nâ€¢ Ask thoughtful questions\nâ€¢ Offer constructive support\n\nAuthentic connections lead to lasting friendships and mutual growth!');
    }

    function shareResources() {
        alert('ðŸ“š Share Learning Resources:\n\nHelp the community grow together:\n\nâ€¢ Recommend helpful tutorials\nâ€¢ Share technique discoveries\nâ€¢ Suggest useful art supplies\nâ€¢ Post about inspiring books/videos\nâ€¢ Offer tips you\'ve learned\n\nKnowledge shared multiplies. Your insights could be exactly what another artist needs!');
    }

    // Feature Guide Functions - Enhanced for Emerging Artists
    function openStarterGuide() {
        alert('ðŸŒ± Getting Started Guide:\n\n1. Set up a simple, well-lit workspace\n2. Choose your preferred medium and stick with it initially\n3. Take high-quality photos of your current work\n4. Write a brief artist statement (1-2 paragraphs)\n5. Research where artists in your style gather online\n6. Start documenting your process\n\nRemember: Start small, stay consistent, and be authentic to your voice!');
    }

    function openGrowthTips() {
        alert('ðŸ“ˆ Growth Strategies for Small Accounts:\n\nâ€¢ Post consistently (even works in progress count!)\nâ€¢ Use 10-15 relevant hashtags per post\nâ€¢ Engage genuinely with other artists before self-promoting\nâ€¢ Share your process, not just final pieces\nâ€¢ Tell stories about your inspiration and challenges\nâ€¢ Be patient - authentic growth takes time\nâ€¢ Focus on quality connections over quantity\n\nAuthenticity beats perfection every time!');
    }

    function openStoryGuide() {
        alert('ðŸ“– Craft Your Artist Story:\n\nâ€¢ What first drew you to art?\nâ€¢ What themes or subjects fascinate you?\nâ€¢ What techniques are you currently exploring?\nâ€¢ What challenges inspire your creative growth?\nâ€¢ What do you hope viewers feel from your work?\nâ€¢ What\'s your artistic background or journey?\n\nYour unique perspective and journey are your greatest strengths. Share them openly!');
    }

    function openCommunityList() {
        alert('ðŸ¤ Find Your Artistic Tribe:\n\nâ€¢ Instagram: Search #[yourmedium]artist hashtags\nâ€¢ Reddit: r/ArtCrit, r/learnart, r/[yourmedium]\nâ€¢ Discord: Join art servers in your specific style\nâ€¢ Local: Check libraries, coffee shops, art centers\nâ€¢ Facebook: Search for local artist groups\nâ€¢ Online forums: DeviantArt, ArtStation communities\n\nTip: Start engaging and supporting others before promoting your own work!');
    }

    function shareInspiration() {
        alert('Share Inspiration feature coming soon! Post references, ideas, and creative sparks.');
    }

    // Showcase Filtering and Liking System
    let userId = localStorage.getItem('userId') || generateUserId();
    let likedArtwork = JSON.parse(localStorage.getItem(`likedArtwork_${userId}`) || '[]');
    let artworkLikeCounts = JSON.parse(localStorage.getItem('artworkLikeCounts') || '{}');
    let userLikeTimestamps = JSON.parse(localStorage.getItem(`userLikeTimestamps_${userId}`) || '{}');
    let artworkLikers = JSON.parse(localStorage.getItem('artworkLikers') || '{}'); // Track who liked what
    let currentFilter = 'all';
    let currentMediumFilter = 'all';

    // Initialize like counts for placeholders (but don't allow new likes)
    const PLACEHOLDER_IDS = ['1', '2', '3', '4', '5', '6'];
    const SPAM_PREVENTION_DELAY = 2000; // 2 seconds between likes

    function generateUserId() {
        const id = 'user_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
        localStorage.setItem('userId', id);
        return id;
    }

    function hasUserLikedArtwork(artworkId) {
        // Check if this specific user has already liked this artwork
        return likedArtwork.includes(artworkId) || 
               (artworkLikers[artworkId] && artworkLikers[artworkId].includes(userId));
    }

    function initializeLikeCounts() {
        // Set initial like counts for placeholders if not already set
        if (!artworkLikeCounts['1']) artworkLikeCounts['1'] = 12;
        if (!artworkLikeCounts['2']) artworkLikeCounts['2'] = 8;
        if (!artworkLikeCounts['3']) artworkLikeCounts['3'] = 15;
        if (!artworkLikeCounts['4']) artworkLikeCounts['4'] = 6;
        if (!artworkLikeCounts['5']) artworkLikeCounts['5'] = 20;
        if (!artworkLikeCounts['6']) artworkLikeCounts['6'] = 11;
        
        localStorage.setItem('artworkLikeCounts', JSON.stringify(artworkLikeCounts));
    }

    function canUserLike(artworkId) {
        const now = Date.now();
        const lastLikeTime = userLikeTimestamps[artworkId] || 0;
        
        // Check if enough time has passed since last like action
        if (now - lastLikeTime < SPAM_PREVENTION_DELAY) {
            return false;
        }
        
        return true;
    }

    function isPlaceholder(artworkId) {
        return PLACEHOLDER_IDS.includes(artworkId);
    }

    function toggleLike(button) {
        const artworkId = button.getAttribute('data-artwork-id');
        
        // Prevent liking placeholders
        if (isPlaceholder(artworkId)) {
            showLikeMessage('Placeholder artworks cannot be liked. Submit your own work to receive likes!');
            return;
        }
        
        // Prevent spam clicking
        if (!canUserLike(artworkId)) {
            showLikeMessage('Please wait before liking again.');
            return;
        }
        
        const likeCountSpan = button.querySelector('.like-count');
        const heartSpan = button.querySelector('.heart');
        
        // Initialize like count if it doesn't exist
        if (!artworkLikeCounts[artworkId]) {
            artworkLikeCounts[artworkId] = 0;
        }
        
        // Initialize likers array if it doesn't exist
        if (!artworkLikers[artworkId]) {
            artworkLikers[artworkId] = [];
        }
        
        let currentLikes = artworkLikeCounts[artworkId];
        const hasLiked = hasUserLikedArtwork(artworkId);
        
        if (hasLiked) {
            // Unlike - remove like
            likedArtwork = likedArtwork.filter(id => id !== artworkId);
            artworkLikers[artworkId] = artworkLikers[artworkId].filter(id => id !== userId);
            button.classList.remove('liked');
            heartSpan.textContent = 'â™¡';
            artworkLikeCounts[artworkId] = Math.max(0, currentLikes - 1);
            showLikeMessage('Like removed');
        } else {
            // Like - add like (only if not already liked by this user)
            if (!hasUserLikedArtwork(artworkId)) {
                likedArtwork.push(artworkId);
                artworkLikers[artworkId].push(userId);
                button.classList.add('liked');
                heartSpan.textContent = 'â™¥';
                artworkLikeCounts[artworkId] = currentLikes + 1;
                showLikeMessage('Artwork liked!');
            } else {
                // User has already liked this artwork
                showLikeMessage('You have already liked this artwork!');
                return;
            }
        }
        
        // Update display
        likeCountSpan.textContent = artworkLikeCounts[artworkId];
        
        // Update the data attribute for sorting
        button.closest('.showcase-item').setAttribute('data-likes', artworkLikeCounts[artworkId]);
        
        // Record timestamp for spam prevention
        userLikeTimestamps[artworkId] = Date.now();
        
        // Save to localStorage with user-specific keys
        localStorage.setItem(`likedArtwork_${userId}`, JSON.stringify(likedArtwork));
        localStorage.setItem('artworkLikeCounts', JSON.stringify(artworkLikeCounts));
        localStorage.setItem('artworkLikers', JSON.stringify(artworkLikers));
        localStorage.setItem(`userLikeTimestamps_${userId}`, JSON.stringify(userLikeTimestamps));
        
        // Add visual feedback
        button.style.transform = 'scale(1.1)';
        setTimeout(() => {
            button.style.transform = 'scale(1)';
        }, 150);
        
        // Prevent double clicking by temporarily disabling
        button.disabled = true;
        setTimeout(() => {
            button.disabled = false;
        }, 500);
    }

    function showLikeMessage(message) {
        // Create or update like message
        let messageEl = document.getElementById('like-message');
        if (!messageEl) {
            messageEl = document.createElement('div');
            messageEl.id = 'like-message';
            messageEl.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: var(--color-primary-accent);
                color: var(--color-background);
                padding: 1rem 1.5rem;
                border-radius: 8px;
                z-index: 1000;
                font-size: 0.9rem;
                box-shadow: 0 4px 12px rgba(0,0,0,0.3);
                transition: all 0.3s ease;
                transform: translateX(100%);
            `;
            document.body.appendChild(messageEl);
        }
        
        messageEl.textContent = message;
        messageEl.style.transform = 'translateX(0)';
        
        setTimeout(() => {
            messageEl.style.transform = 'translateX(100%)';
        }, 2000);
    }

    function filterShowcase(filterType) {
        currentFilter = filterType;
        
        // Update active button
        document.querySelectorAll('.filter-btn').forEach(btn => {
            btn.classList.remove('active');
            if (btn.getAttribute('data-filter') === filterType) {
                btn.classList.add('active');
            }
        });
        
        applyFilters();
    }

    function toggleFilters() {
        const filtersContent = document.querySelector('.filters-content');
        const toggleBtn = document.querySelector('.filter-toggle');
        
        filtersContent.classList.toggle('active');
        toggleBtn.classList.toggle('active');
        
        if (filtersContent.classList.contains('active')) {
            toggleBtn.textContent = 'Hide Filters';
        } else {
            toggleBtn.textContent = 'Show Filters';
        }
    }

    function filterByMedium(medium) {
        currentMediumFilter = medium;
        applyFilters();
    }

    function applyFilters() {
        const items = document.querySelectorAll('.showcase-item');
        
        // Add filtering class for smooth transition
        items.forEach(item => {
            item.classList.add('filtering');
        });
        
        setTimeout(() => {
            items.forEach(item => {
                const categories = item.getAttribute('data-category').split(' ');
                const medium = item.getAttribute('data-medium');
                
                let showItem = true;
                
                // Apply category filter
                if (currentFilter !== 'all' && !categories.includes(currentFilter)) {
                    showItem = false;
                }
                
                // Apply medium filter
                if (currentMediumFilter !== 'all' && medium !== currentMediumFilter) {
                    showItem = false;
                }
                
                if (showItem) {
                    item.style.display = 'block';
                    item.classList.remove('hidden');
                } else {
                    item.style.display = 'none';
                    item.classList.add('hidden');
                }
                
                // Remove filtering class
                item.classList.remove('filtering');
            });
            
            // Apply sorting after filtering
            sortShowcase();
        }, 150);
    }

    function sortShowcase() {
        const grid = document.querySelector('.showcase-grid');
        const items = Array.from(grid.querySelectorAll('.showcase-item:not(.hidden)'));
        
        if (currentFilter === 'newest') {
            items.sort((a, b) => new Date(b.getAttribute('data-date')) - new Date(a.getAttribute('data-date')));
        } else if (currentFilter === 'popular') {
            items.sort((a, b) => parseInt(b.getAttribute('data-likes')) - parseInt(a.getAttribute('data-likes')));
        }
        
        // Re-append sorted items
        items.forEach(item => grid.appendChild(item));
    }

    // Initialize liked artwork on page load
    document.addEventListener('DOMContentLoaded', function() {
        // Initialize like counts
        initializeLikeCounts();
        
        // Set up filter buttons
        document.querySelectorAll('.filter-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                filterShowcase(this.getAttribute('data-filter'));
            });
        });
        
        // Initialize liked states and update like counts from storage
        document.querySelectorAll('.showcase-item').forEach(item => {
            const artworkId = item.querySelector('[data-artwork-id]')?.getAttribute('data-artwork-id');
            if (artworkId && artworkLikeCounts[artworkId] !== undefined) {
                const likeCountSpan = item.querySelector('.like-count');
                const button = item.querySelector('.like-btn');
                
                // Update like count display from stored data
                likeCountSpan.textContent = artworkLikeCounts[artworkId];
                item.setAttribute('data-likes', artworkLikeCounts[artworkId]);
                
                // Set liked state if this specific user has liked this artwork
                if (hasUserLikedArtwork(artworkId)) {
                    button.classList.add('liked');
                    button.querySelector('.heart').textContent = 'â™¥';
                }
                
                // Add visual indicator for placeholders
                if (isPlaceholder(artworkId)) {
                    button.style.opacity = '0.6';
                    button.title = 'Placeholder artworks cannot be liked';
                    button.style.cursor = 'not-allowed';
                }
            }
        });
        
        // Initialize with 'all' filter
        filterShowcase('all');
    });
    </script>
    
    <!-- Community JavaScript -->
    <script src="../scripts/community.js"></script>
    
    <!-- Main Navigation Script -->
    <script>
        // Mobile Navigation Toggle
        document.addEventListener('DOMContentLoaded', function() {
            const hamburger = document.querySelector('.hamburger');
            const navMenu = document.querySelector('.nav-links');
            
            if (hamburger && navMenu) {
                hamburger.addEventListener('click', function() {
                    navMenu.classList.toggle('active');
                    hamburger.classList.toggle('active');
                });
                
                // Close menu when clicking on nav links
                document.querySelectorAll('.nav-links li a').forEach(link => {
                    link.addEventListener('click', () => {
                        navMenu.classList.remove('active');
                        hamburger.classList.remove('active');
                    });
                });
                
                // Close menu when clicking outside
                document.addEventListener('click', function(e) {
                    if (!hamburger.contains(e.target) && !navMenu.contains(e.target)) {
                        navMenu.classList.remove('active');
                        hamburger.classList.remove('active');
                    }
                });
            }
        });
    </script>

    <!-- Emergency Tab Fix -->
    <script>
    window.addEventListener('load', function() {
        console.log('Emergency tab script loaded');
        
        // Force remove active from all first
        document.querySelectorAll('.tab-content').forEach(section => {
            section.classList.remove('active');
        });
        
        // Show prompts tab by default
        const promptsTab = document.getElementById('prompts');
        if (promptsTab) {
            promptsTab.classList.add('active');
        }
        
        // Add click handlers with force
        const tabButtons = document.querySelectorAll('.tab-btn');
        tabButtons.forEach((btn, index) => {
            btn.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                
                const targetId = this.getAttribute('data-tab');
                console.log('Emergency script - Tab clicked:', targetId);
                
                // Force hide all tabs
                document.querySelectorAll('.tab-content').forEach(section => {
                    section.style.display = 'none';
                    section.classList.remove('active');
                });
                
                // Force remove active from all buttons
                document.querySelectorAll('.tab-btn').forEach(button => {
                    button.classList.remove('active');
                });
                
                // Force show target tab
                const targetSection = document.getElementById(targetId);
                if (targetSection) {
                    targetSection.style.display = 'block';
                    targetSection.classList.add('active');
                    this.classList.add('active');
                    console.log('Emergency script - Showed:', targetId);
                } else {
                    console.error('Emergency script - Target not found:', targetId);
                }
            }, true);
        });
    });

    // Authentication System
    let pendingAction = null;
    let pendingActionData = null;

    // Check if user is logged in
    function isLoggedIn() {
        return localStorage.getItem('communityUser') !== null;
    }

    // Get current user data
    function getCurrentUser() {
        const userData = localStorage.getItem('communityUser');
        return userData ? JSON.parse(userData) : null;
    }

    // Require login before performing action
    function requireLogin(action, data = null) {
        if (isLoggedIn()) {
            executeAction(action, data);
        } else {
            pendingAction = action;
            pendingActionData = data;
            openLoginModal();
        }
    }

    // Execute the pending action after login
    function executeAction(action, data) {
        const user = getCurrentUser();
        if (!user) return;

        switch(action) {
            case 'applyCollaboration':
                applyToCollaboration(data);
                break;
            case 'joinArtTrade':
                joinArtTrade();
                break;
            case 'submitToZine':
                submitToZine();
                break;
            case 'postCollaboration':
                postCollaboration();
                break;
            case 'rsvpEvent':
                rsvpToEvent(data);
                break;
            case 'postEvent':
                postEvent();
                break;
            case 'submitResource':
                submitResource();
                break;
            case 'findCollaborator':
                findCollaborator();
                break;
            case 'hostEvent':
                hostEvent();
                break;
            case 'shareResource':
                shareResource();
                break;
            case 'askQuestion':
                askQuestion();
                break;
            case 'offerHelp':
                offerHelp();
                break;
            case 'requestFeedback':
                requestFeedback();
                break;
            default:
                console.log('Unknown action:', action);
        }
    }

    // Modal functions
    function openLoginModal() {
        const modal = document.getElementById('loginModal');
        if (modal) {
            modal.classList.add('show');
            modal.style.display = 'flex';
            document.body.style.overflow = 'hidden';
            generateCaptcha();
        }
    }

    function closeLoginModal(event) {
        const modal = document.getElementById('loginModal');
        if (modal && (!event || event.target === modal || event.target.classList.contains('modal-close') || event.target.classList.contains('cancel-btn'))) {
            modal.classList.remove('show');
            modal.style.display = 'none';
            document.body.style.overflow = 'auto';
            resetLoginForm();
            pendingAction = null;
            pendingActionData = null;
        }
    }

    // Captcha system
    function generateCaptcha() {
        const num1 = Math.floor(Math.random() * 10) + 1;
        const num2 = Math.floor(Math.random() * 10) + 1;
        const operation = Math.random() > 0.5 ? '+' : '-';
        
        let question, answer;
        if (operation === '+') {
            question = `${num1} + ${num2}`;
            answer = num1 + num2;
        } else {
            // Ensure no negative results
            const larger = Math.max(num1, num2);
            const smaller = Math.min(num1, num2);
            question = `${larger} - ${smaller}`;
            answer = larger - smaller;
        }
        
        document.getElementById('captchaQuestion').textContent = question;
        document.getElementById('captchaChallenge').dataset.answer = answer;
    }

    // Show captcha when robot checkbox is clicked
    document.addEventListener('DOMContentLoaded', function() {
        const robotCheck = document.getElementById('robotCheck');
        if (robotCheck) {
            robotCheck.addEventListener('change', function() {
                const challenge = document.getElementById('captchaChallenge');
                if (this.checked) {
                    challenge.style.display = 'block';
                    generateCaptcha();
                } else {
                    challenge.style.display = 'none';
                }
            });
        }
    });

    // Community rules functions
    function showCommunityRules() {
        document.getElementById('loginForm').style.display = 'none';
        document.getElementById('communityRules').style.display = 'block';
    }

    function hideCommunityRules() {
        document.getElementById('communityRules').style.display = 'none';
        document.getElementById('loginForm').style.display = 'block';
    }

    // Handle login form submission
    function handleLogin(event) {
        event.preventDefault();
        
        const form = event.target;
        const email = form.email.value.trim();
        const name = form.name.value.trim();
        const robotCheck = document.getElementById('robotCheck').checked;
        const captchaAnswer = document.getElementById('captchaAnswer').value;
        const correctAnswer = document.getElementById('captchaChallenge').dataset.answer;
        const rulesAccepted = document.getElementById('communityRules').checked;
        
        // Validation
        if (!email || !name) {
            showNotification('Please fill in all required fields', 'error');
            return;
        }
        
        if (!robotCheck) {
            showNotification('Please verify you are not a robot', 'error');
            return;
        }
        
        if (captchaAnswer !== correctAnswer) {
            showNotification('Incorrect captcha answer. Please try again.', 'error');
            generateCaptcha();
            document.getElementById('captchaAnswer').value = '';
            return;
        }
        
        if (!rulesAccepted) {
            showNotification('Please accept the community guidelines', 'error');
            return;
        }
        
        // Content filtering
        if (containsInappropriateContent(name)) {
            showNotification('Display name contains inappropriate content', 'error');
            return;
        }
        
        // Save user data
        const userData = {
            email: email,
            name: name,
            joinDate: new Date().toISOString(),
            verified: true,
            warnings: 0
        };
        
        localStorage.setItem('communityUser', JSON.stringify(userData));
        
        // Close modal and execute pending action
        closeLoginModal();
        
        if (pendingAction) {
            executeAction(pendingAction, pendingActionData);
            pendingAction = null;
            pendingActionData = null;
        }
        
        showNotification(`ðŸŽ‰ Welcome to the community, ${name}!`, 'success');
    }

    // Reset login form
    function resetLoginForm() {
        const form = document.querySelector('.login-form');
        if (form) {
            form.reset();
            document.getElementById('captchaChallenge').style.display = 'none';
            document.getElementById('robotCheck').checked = false;
        }
    }

    // Content filtering system
    function containsInappropriateContent(text) {
        const inappropriateWords = [
            'spam', 'scam', 'hate', 'offensive', 'inappropriate',
            // Add more words as needed, but keep list reasonable
        ];
        
        const lowerText = text.toLowerCase();
        return inappropriateWords.some(word => lowerText.includes(word));
    }

    // Rate limiting system
    function checkRateLimit(action) {
        const user = getCurrentUser();
        if (!user) return false;
        
        const now = Date.now();
        const rateLimitKey = `rateLimit_${action}_${user.email}`;
        const lastAction = localStorage.getItem(rateLimitKey);
        
        if (lastAction && (now - parseInt(lastAction)) < 60000) { // 1 minute cooldown
            showNotification('â° Please wait before performing this action again', 'error');
            return false;
        }
        
        localStorage.setItem(rateLimitKey, now.toString());
        return true;
    }

    // Action implementations
    function applyToCollaboration(projectId) {
        if (!checkRateLimit('collaboration')) return;
        showNotification('ðŸ“ Collaboration application submitted! The project organizer will contact you via email.', 'success');
    }

    function joinArtTrade() {
        if (!checkRateLimit('artTrade')) return;
        showNotification('You\'ve joined the art trading circle! You\'ll receive pairing details via email.');
    }

    function submitToZine() {
        if (!checkRateLimit('zineSubmission')) return;
        showNotification('ðŸ“– Zine submission form sent to your email! Check for submission guidelines.');
    }

    function postCollaboration() {
        if (!checkRateLimit('postCollab')) return;
        showNotification('ðŸ“‹ Collaboration posting form sent to your email for review and approval.');
    }

    function rsvpToEvent(eventId) {
        if (!checkRateLimit('eventRSVP')) return;
        showNotification('ðŸ“… RSVP confirmed! Event details and updates will be sent to your email.');
    }

    function postEvent() {
        if (!checkRateLimit('postEvent')) return;
        showNotification('ðŸ“… Event submission form sent to your email for review and approval.');
    }

    function submitResource() {
        if (!checkRateLimit('submitResource')) return;
        showNotification('ðŸ“š Resource submission form sent to your email for review and approval.');
    }

    function findCollaborator() {
        showNotification('ðŸ¤ Collaboration matching form sent to your email!');
    }

    function hostEvent() {
        showNotification('ðŸ“… Event hosting guide sent to your email!');
    }

    function shareResource() {
        showNotification('ðŸ“š Resource sharing form sent to your email!');
    }

    function askQuestion() {
        showNotification('â“ Question submission form sent to your email!');
    }

    function offerHelp() {
        showNotification('ðŸ™‹â€â™€ï¸ Help offering form sent to your email!');
    }

    function requestFeedback() {
        showNotification('ðŸ’¬ Feedback request form sent to your email!');
    }

    function trackResourceClick(resourceId) {
        // Track resource usage for analytics
        const clickData = {
            resource: resourceId,
            timestamp: new Date().toISOString(),
            user: getCurrentUser()?.email || 'anonymous'
        };
        
        // In a real implementation, this would send to analytics
        console.log('Resource clicked:', clickData);
    }
    
    // Create from prompt functionality
    function createFromPrompt() {
        // Get the current prompt text
        const promptText = document.getElementById('dailyPrompt').textContent;
        
        // Pre-fill the submission form with the prompt
        openSubmissionModal();
        
        // Add prompt reference to the description field
        setTimeout(() => {
            const descriptionField = document.getElementById('artworkDescription');
            if (descriptionField) {
                descriptionField.value = `Inspired by today's prompt: "${promptText.trim()}"\n\n`;
                descriptionField.focus();
                // Position cursor after the prompt reference
                descriptionField.setSelectionRange(descriptionField.value.length, descriptionField.value.length);
            }
        }, 100);
        
        showNotification('âœ¨ Submission form opened with today\'s prompt! Add your artwork details.');
    }
    
    // Refresh prompt tags only
    function refreshPromptTags() {
        updatePromptTags();
        showNotification('ðŸ·ï¸ Prompt tags have been refreshed!');
    }
    
    // Improved notification system to prevent overlapping
    let notificationQueue = [];
    let currentNotification = null;

    function showNotification(message, type = 'info') {
        // Add to queue if there's a current notification
        if (currentNotification) {
            notificationQueue.push({ message, type });
            return;
        }
        
        displayNotification(message, type);
    }

    function displayNotification(message, type) {
        // Remove any existing notifications first
        const existing = document.querySelector('.community-notification');
        if (existing) {
            existing.remove();
        }
        
        // Create notification element
        const notification = document.createElement('div');
        notification.className = 'community-notification';
        
        // Set styles based on type
        let backgroundColor, textColor;
        if (type === 'error') {
            backgroundColor = 'var(--color-secondary-accent)';
            textColor = 'var(--color-text)';
        } else if (type === 'success') {
            backgroundColor = 'var(--color-primary-accent)';
            textColor = 'var(--color-background)';
        } else {
            backgroundColor = 'var(--color-secondary-accent)';
            textColor = 'var(--color-primary-accent)';
        }
        
        notification.style.cssText = `
            position: fixed;
            top: 20px;
            right: 20px;
            background: ${backgroundColor};
            color: ${textColor};
            padding: 1rem 1.5rem;
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.4);
            z-index: 10000;
            font-family: var(--font-accent);
            font-size: 0.9rem;
            font-weight: 600;
            max-width: 300px;
            border: 1px solid rgba(248, 200, 208, 0.3);
            transform: translateX(100%);
            transition: transform 0.3s ease, opacity 0.3s ease;
            opacity: 0;
        `;
        notification.textContent = message;
        currentNotification = notification;
        
        // Add to page
        document.body.appendChild(notification);
        
        // Show notification with delay for smooth animation
        setTimeout(() => {
            notification.style.transform = 'translateX(0)';
            notification.style.opacity = '1';
        }, 100);
        
        // Hide notification after 4 seconds
        setTimeout(() => {
            hideNotification(notification);
        }, 4000);
    }

    function hideNotification(notification) {
        if (notification && notification.parentNode) {
            notification.style.transform = 'translateX(100%)';
            notification.style.opacity = '0';
            
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.remove();
                }
                
                // Clear current notification
                if (currentNotification === notification) {
                    currentNotification = null;
                }
                
                // Show next notification in queue
                if (notificationQueue.length > 0) {
                    const next = notificationQueue.shift();
                    setTimeout(() => displayNotification(next.message, next.type), 200);
                }
            }, 300);
        }
    }
    
    // Admin Functions for Manual Artwork Addition
    function addApprovedArtwork(artworkData) {
        const grid = document.querySelector('.showcase-grid');
        if (!grid) {
            console.error('Showcase grid not found');
            return false;
        }
        
        // Generate unique ID for approved artwork
        const artworkId = 'approved-' + Date.now();
        
        // Initialize like count
        if (typeof artworkLikeCounts !== 'undefined') {
            artworkLikeCounts[artworkId] = 0;
            localStorage.setItem('artworkLikeCounts', JSON.stringify(artworkLikeCounts));
        }
        
        // Create new artwork item
        const newItem = document.createElement('div');
        newItem.className = 'showcase-item';
        newItem.setAttribute('data-category', `${artworkData.category || 'other'} all recent`);
        newItem.setAttribute('data-medium', artworkData.medium || 'mixed-media');
        newItem.setAttribute('data-likes', '0');
        newItem.setAttribute('data-date', new Date().toISOString().split('T')[0]);
        
        // Set innerHTML with the artwork content
        newItem.innerHTML = `
            <img src="${artworkData.imageUrl}" alt="${artworkData.title}" style="width: 100%; height: 100%; object-fit: cover;">
            <div class="showcase-overlay">
                <h4>${artworkData.title}</h4>
                <p><a href="https://instagram.com/${(artworkData.artist_instagram || '@unknown').replace('@', '')}" target="_blank" rel="noopener noreferrer" class="instagram-link">${artworkData.artist_instagram || '@unknown'}</a></p>
                <span class="challenge-tag">${getCategoryDisplayName(artworkData.category)}</span>
                <div class="artwork-stats">
                    <button class="like-btn" onclick="toggleLike(this)" data-artwork-id="${artworkId}">
                        <span class="heart">â™¡</span>
                        <span class="like-count">0</span>
                    </button>
                </div>
            </div>
        `;
        
        // Add to beginning of grid
        grid.insertBefore(newItem, grid.firstChild);
        
        console.log('Approved artwork added to showcase:', artworkData);
        return true;
    }
    
    function getCategoryDisplayName(category) {
        const categoryNames = {
            'daily-prompt': 'Daily Prompt',
            'personal': 'Personal Work',
            'commission': 'Commission',
            'study': 'Study',
            'collaboration': 'Collaboration',
            'other': 'Community Art'
        };
        return categoryNames[category] || 'Community Art';
    }
    
    // Admin console command for quick addition
    // Usage in browser console: quickAddArtwork({title: "Art Title", artist_instagram: "@artist", imageUrl: "data:image...", category: "personal"})
    function quickAddArtwork(data) {
        if (!data.title || !data.artist_instagram || !data.imageUrl) {
            console.error('Missing required fields: title, artist_instagram, imageUrl');
            return false;
        }
        
        const success = addApprovedArtwork(data);
        if (success) {
            showNotification(`âœ… Added "${data.title}" by ${data.artist_instagram} to showcase!`);
            // Switch to showcase tab to show the new artwork
            const showcaseTab = document.querySelector('[data-tab="showcase"]');
            if (showcaseTab) showcaseTab.click();
        }
        return success;
    }
    
    // Check for pending admin additions on page load
    document.addEventListener('DOMContentLoaded', function() {
        // Load approved artworks from API
        loadApprovedArtworks();
        
        // Check if there's a pending artwork addition from admin panel
        const pendingArtwork = localStorage.getItem('pendingApprovalArtwork');
        if (pendingArtwork) {
            try {
                const artworkData = JSON.parse(pendingArtwork);
                if (addApprovedArtwork(artworkData)) {
                    showNotification(`âœ… Approved artwork "${artworkData.title}" has been added!`);
                    localStorage.removeItem('pendingApprovalArtwork');
                }
            } catch (e) {
                console.error('Error processing pending artwork:', e);
                localStorage.removeItem('pendingApprovalArtwork');
            }
        }
    });
    
    // Load approved artworks from API/data file
    async function loadApprovedArtworks() {
        try {
            const response = await fetch('../data/approved_artworks.json');
            if (response.ok) {
                const approvedArtworks = await response.json();
                displayApprovedArtworks(approvedArtworks);
            }
        } catch (error) {
            console.log('No approved artworks file found yet, or error loading:', error);
        }
    }
    
    // Display approved artworks in the showcase
    function displayApprovedArtworks(artworks) {
        const grid = document.querySelector('.showcase-grid');
        if (!grid || !Array.isArray(artworks)) return;
        
        artworks.forEach(artwork => {
            // Check if artwork already exists to avoid duplicates
            const existingArtwork = grid.querySelector(`[data-artwork-id="${artwork.id}"]`);
            if (existingArtwork) return;
            
            // Initialize like count if not present
            if (typeof artworkLikeCounts !== 'undefined') {
                artworkLikeCounts[artwork.id] = artwork.likes || 0;
                localStorage.setItem('artworkLikeCounts', JSON.stringify(artworkLikeCounts));
            }
            
            // Create new artwork item
            const newItem = document.createElement('div');
            newItem.className = 'showcase-item';
            newItem.setAttribute('data-category', `${artwork.category || 'other'} all recent`);
            newItem.setAttribute('data-medium', artwork.medium || 'mixed-media');
            newItem.setAttribute('data-likes', artwork.likes || '0');
            newItem.setAttribute('data-date', artwork.date_added);
            newItem.setAttribute('data-artwork-id', artwork.id);
            
            newItem.innerHTML = `
                <img src="${artwork.image_url}" alt="${artwork.artwork_title}" style="width: 100%; height: 100%; object-fit: cover;" loading="lazy">
                <div class="showcase-overlay">
                    <h4>${artwork.artwork_title}</h4>
                    <p><a href="https://instagram.com/${artwork.artist_instagram?.replace('@', '')}" target="_blank" rel="noopener noreferrer" class="instagram-link">${artwork.artist_instagram}</a></p>
                    <span class="challenge-tag">${getCategoryDisplayName(artwork.category)}</span>
                    <div class="artwork-stats">
                        <button class="like-btn" onclick="toggleLike(this)" data-artwork-id="${artwork.id}">
                            <span class="heart">â™¡</span>
                            <span class="like-count">${artwork.likes || 0}</span>
                        </button>
                    </div>
                </div>
            `;
            
            // Add to showcase grid
            grid.appendChild(newItem);
        });
        
        console.log(`Loaded ${artworks.length} approved artworks`);
    }
    
    // Refresh approved artworks (useful for admin)
    function refreshApprovedArtworks() {
        // Clear existing API artworks
        const grid = document.querySelector('.showcase-grid');
        if (grid) {
            const apiArtworks = grid.querySelectorAll('[data-artwork-id^="api-"]');
            apiArtworks.forEach(item => item.remove());
        }
        
        // Reload from API
        loadApprovedArtworks();
        showNotification('ðŸ”„ Refreshed approved artworks from email approvals!');
    }
    </script>

    <!-- Include main script for floating icons -->
    <script src="../scripts/main.js"></script>

    <!-- Footer -->
    <footer class="main-footer">
        <div class="footer-content">
            <img src="../images/logo/logo4white.png" alt="Leah Cortez Logo" class="footer-logo" loading="lazy">
            <p class="copyright">Leah Cortez Â© 2025</p>
        </div>
    </footer>
</body>
</html>
